import pandas as pd
import datetime

class DataHandler:
    def __init__(self, scraped_data):
        self.data = scraped_data

    def convert_to_list_of_dict(self):
        '''convert scraped data to the list of dict'''
        element = self.data[0]
        result = [[{header: value for header, value in element}] for element in self.data]

        #flatten list of list of dictionaries
        result = [ items for sublist in result for items in sublist]
        self.data = result


    def convert_to_pandas_df(self):
        '''takes scraped data that was converted to the list of dict and convert them to pandas df'''
        self.convert_to_list_of_dict()
        data = self.data
        pandas_df = pd.DataFrame(data)
        self.pandas_data = pandas_df
        return pandas_df


if __name__ == '__main__':
    data = [[('NAME', 'AGILENT TECHNOLOGIES, INC.'), ('YIELD', 0.83), ('FWD_DIV', 0.94), ('FREQ', 'Quarterly'), ('QUALIFIED?', 'Qualified'), ('DECLARED_DATE', datetime.date(2023, 11, 15)), ('EX-DIV_DATE', datetime.date(2023, 12, 29)), ('PAY_DATE', datetime.date(2023, 1, 24)), ('AMOUNT', 0.24), ('LAST_AMOUNT', 0.23), ('CHANGE', 'INCREASE'), ('DECLARED?', 'Declared')], [('NAME', 'Gabelli Dividend & Income Trust - 5.375% PRF PERPETUAL USD 25 - Ser H'), ('YIELD', 5.64), ('FWD_DIV', 1.34), ('FREQ', 'Quarterly'), ('QUALIFIED?', 'Unknown'), ('DECLARED_DATE', datetime.date(2023, 11, 15)), ('EX-DIV_DATE', datetime.date(2023, 12, 15)), ('PAY_DATE', datetime.date(2023, 12, 26)), ('AMOUNT', 0.34), ('LAST_AMOUNT', 0.34), ('CHANGE', 'NO CHANGE'), ('DECLARED?', 'Declared')], [('NAME', 'Andover Bancorp Inc. Ohio'), ('YIELD', 3.8), ('FWD_DIV', 0.75), ('FREQ', 'Semi Annually'), ('QUALIFIED?', 'Qualified'), ('DECLARED_DATE', datetime.date(2023, 11, 15)), ('EX-DIV_DATE', datetime.date(2023, 12, 12)), ('PAY_DATE', datetime.date(2023, 1, 2)), ('AMOUNT', 0.38), ('LAST_AMOUNT', 0.38), ('CHANGE', 'NO CHANGE'), ('DECLARED?', 'Declared')], [('NAME', 'Brighthouse Financial, Inc.'), ('YIELD', 8.09), ('FWD_DIV', 1.16), ('FREQ', 'Quarterly'), ('QUALIFIED?', 'Qualified'), ('DECLARED_DATE', datetime.date(2023, 11, 15)), ('EX-DIV_DATE', datetime.date(2023, 12, 7)), ('PAY_DATE', datetime.date(2023, 12, 26)), ('AMOUNT', 0.29), ('LAST_AMOUNT', 0.29), ('CHANGE', 'NO CHANGE'), ('DECLARED?', 'Declared')], [('NAME', 'Brighthouse Financial, Inc.'), ('YIELD', 7.84), ('FWD_DIV', 1.65), ('FREQ', 'Quarterly'), ('QUALIFIED?', 'Non-qualified'), ('DECLARED_DATE', datetime.date(2023, 11, 15)), ('EX-DIV_DATE', datetime.date(2023, 12, 7)), ('PAY_DATE', datetime.date(2023, 12, 26)), ('AMOUNT', 0.41), ('LAST_AMOUNT', 0.41), ('CHANGE', 'NO CHANGE'), ('DECLARED?', 'Declared')], [('NAME', 'Gaslog Partners LP - FXDFR PRF PERPETUAL USD 25 - Ser C'), ('YIELD', 9.17), ('FWD_DIV', 2.13), ('FREQ', 'Quarterly'), ('QUALIFIED?', 'Qualified'), ('DECLARED_DATE', datetime.date(2023, 11, 15)), ('EX-DIV_DATE', datetime.date(2023, 12, 7)), ('PAY_DATE', datetime.date(2023, 12, 15)), ('AMOUNT', 0.53), ('LAST_AMOUNT', 0.53), ('CHANGE', 'NO CHANGE'), ('DECLARED?', 'Declared')], [('NAME', 'HIREQUEST, INC.'), ('YIELD', 1.63), ('FWD_DIV', 0.24), ('FREQ', 'Quarterly'), ('QUALIFIED?', 'Qualified'), ('DECLARED_DATE', datetime.date(2023, 11, 15)), ('EX-DIV_DATE', datetime.date(2023, 11, 30)), ('PAY_DATE', datetime.date(2023, 12, 15)), ('AMOUNT', 0.06), ('LAST_AMOUNT', 0.06), ('CHANGE', 'NO CHANGE'), ('DECLARED?', 'Declared')], [('NAME', 'KAMAN CORPORATION'), ('YIELD', 3.92), ('FWD_DIV', 0.8), ('FREQ', 'Quarterly'), ('QUALIFIED?', 'Qualified'), ('DECLARED_DATE', datetime.date(2023, 11, 15)), ('EX-DIV_DATE', datetime.date(2023, 12, 18)), ('PAY_DATE', datetime.date(2023, 1, 11)), ('AMOUNT', 0.2), ('LAST_AMOUNT', 0.2), ('CHANGE', 'NO CHANGE'), ('DECLARED?', 'Declared')], [('NAME', 'QUAKER CHEMICAL CORPORATION'), ('YIELD', 1.04), ('FWD_DIV', 1.82), ('FREQ', 'Quarterly'), ('QUALIFIED?', 'Qualified'), ('DECLARED_DATE', datetime.date(2023, 11, 15)), ('EX-DIV_DATE', datetime.date(2023, 1, 16)), ('PAY_DATE', datetime.date(2023, 1, 31)), ('AMOUNT', 0.46), ('LAST_AMOUNT', 0.46), ('CHANGE', 'NO CHANGE'), ('DECLARED?', 'Declared')], [('NAME', 'KULICKE AND SOFFA INDUSTRIES, INC.'), ('YIELD', 1.58), ('FWD_DIV', 0.8), ('FREQ', 'Quarterly'), ('QUALIFIED?', 'Unknown'), ('DECLARED_DATE', datetime.date(2023, 11, 15)), ('EX-DIV_DATE', datetime.date(2023, 12, 20)), ('PAY_DATE', datetime.date(2023, 1, 9)), ('AMOUNT', 0.2), ('LAST_AMOUNT', 0.19), ('CHANGE', 'INCREASE'), ('DECLARED?', 'Declared')], [('NAME', 'Merchants Bancorp'), ('YIELD', 6.9), ('FWD_DIV', 1.5), ('FREQ', 'Quarterly'), ('QUALIFIED?', 'Qualified'), ('DECLARED_DATE', datetime.date(2023, 11, 15)), ('EX-DIV_DATE', datetime.date(2023, 12, 14)), ('PAY_DATE', datetime.date(2023, 1, 2)), ('AMOUNT', 0.38), ('LAST_AMOUNT', 0.38), ('CHANGE', 'NO CHANGE'), ('DECLARED?', 'Declared')], [('NAME', 'Merchants Bancorp'), ('YIELD', 0.97), ('FWD_DIV', 0.32), ('FREQ', 'Quarterly'), ('QUALIFIED?', 'Qualified'), ('DECLARED_DATE', datetime.date(2023, 11, 15)), ('EX-DIV_DATE', datetime.date(2023, 12, 14)), ('PAY_DATE', datetime.date(2023, 1, 2)), ('AMOUNT', 0.08), ('LAST_AMOUNT', 0.08), ('CHANGE', 'NO CHANGE'), ('DECLARED?', 'Declared')], [('NAME', 'Merchants Bancorp'), ('YIELD', 8.12), ('FWD_DIV', 1.5), ('FREQ', 'Quarterly'), ('QUALIFIED?', 'Qualified'), ('DECLARED_DATE', datetime.date(2023, 11, 15)), ('EX-DIV_DATE', datetime.date(2023, 12, 14)), ('PAY_DATE', datetime.date(2023, 1, 2)), ('AMOUNT', 0.38), ('LAST_AMOUNT', 0.38), ('CHANGE', 'NO CHANGE'), ('DECLARED?', 'Declared')], [('NAME', 'Equitable Holdings Inc - 5.25% PRF PERPETUAL USD 25 - 1/1000th Int Ser A/2023'), ('YIELD', 6.51), ('FWD_DIV', 1.31), ('FREQ', 'Quarterly'), ('QUALIFIED?', 'Qualified'), ('DECLARED_DATE', datetime.date(2023, 11, 15)), ('EX-DIV_DATE', datetime.date(2023, 12, 1)), ('PAY_DATE', datetime.date(2023, 12, 15)), ('AMOUNT', 0.33), ('LAST_AMOUNT', 0.33), ('CHANGE', 'NO CHANGE'), ('DECLARED?', 'Declared')], [('NAME', 'Air Products & Chemicals, Inc.'), ('YIELD', 2.59), ('FWD_DIV', 7.0), ('FREQ', 'Quarterly'), ('QUALIFIED?', 'Qualified'), ('DECLARED_DATE', datetime.date(2023, 11, 15)), ('EX-DIV_DATE', datetime.date(2023, 12, 29)), ('PAY_DATE', datetime.date(2023, 2, 12)), ('AMOUNT', 1.75), ('LAST_AMOUNT', 1.75), ('CHANGE', 'NO CHANGE'), ('DECLARED?', 'Declared')], [('NAME', 'Dole plc'), ('YIELD', 2.86), ('FWD_DIV', 0.32), ('FREQ', 'Quarterly'), ('QUALIFIED?', 'Unknown'), ('DECLARED_DATE', datetime.date(2023, 11, 15)), ('EX-DIV_DATE', datetime.date(2023, 12, 13)), ('PAY_DATE', datetime.date(2023, 1, 4)), ('AMOUNT', 0.08), ('LAST_AMOUNT', 0.08), ('CHANGE', 'NO CHANGE'), ('DECLARED?', 'Declared')], [('NAME', 'ESSA Bancorp, Inc.'), ('YIELD', 3.64), ('FWD_DIV', 0.6), ('FREQ', 'Quarterly'), ('QUALIFIED?', 'Qualified'), ('DECLARED_DATE', datetime.date(2023, 11, 15)), ('EX-DIV_DATE', datetime.date(2023, 12, 14)), ('PAY_DATE', datetime.date(2023, 12, 29)), ('AMOUNT', 0.15), ('LAST_AMOUNT', 0.15), ('CHANGE', 'NO CHANGE'), ('DECLARED?', 'Declared')], [('NAME', 'First Citizens Bancshares Inc'), ('YIELD', 2.5), ('FWD_DIV', 1.4), ('FREQ', 'Quarterly'), ('QUALIFIED?', 'Qualified'), ('DECLARED_DATE', datetime.date(2023, 11, 15)), ('EX-DIV_DATE', datetime.date(2023, 11, 30)), ('PAY_DATE', datetime.date(2023, 12, 15)), ('AMOUNT', 0.45), ('LAST_AMOUNT', 0.35), ('CHANGE', 'SPECIAL'), ('DECLARED?', 'Declared')], [('NAME', 'Financial Institutions, Inc.'), ('YIELD', 6.66), ('FWD_DIV', 1.2), ('FREQ', 'Quarterly'), ('QUALIFIED?', 'Qualified'), ('DECLARED_DATE', datetime.date(2023, 11, 15)), ('EX-DIV_DATE', datetime.date(2023, 12, 13)), ('PAY_DATE', datetime.date(2023, 1, 2)), ('AMOUNT', 0.3), ('LAST_AMOUNT', 0.3), ('CHANGE', 'NO CHANGE'), ('DECLARED?', 'Declared')], [('NAME', 'FIRST US BANCSHARES INC'), ('YIELD', 2.15), ('FWD_DIV', 0.2), ('FREQ', 'Quarterly'), ('QUALIFIED?', 'Qualified'), ('DECLARED_DATE', datetime.date(2023, 11, 15)), ('EX-DIV_DATE', datetime.date(2023, 12, 7)), ('PAY_DATE', datetime.date(2023, 1, 2)), ('AMOUNT', 0.05), ('LAST_AMOUNT', 0.05), ('CHANGE', 'NO CHANGE'), ('DECLARED?', 'Declared')], [('NAME', 'ALLSTATE CORP'), ('YIELD', 2.65), ('FWD_DIV', 3.56), ('FREQ', 'Quarterly'), ('QUALIFIED?', 'Qualified'), ('DECLARED_DATE', datetime.date(2023, 11, 15)), ('EX-DIV_DATE', datetime.date(2023, 11, 29)), ('PAY_DATE', datetime.date(2023, 1, 2)), ('AMOUNT', 0.89), ('LAST_AMOUNT', 0.89), ('CHANGE', 'NO CHANGE'), ('DECLARED?', 'Declared')], [('NAME', 'COMMUNITY BANK SYSTEM, INC.'), ('YIELD', 3.96), ('FWD_DIV', 1.8), ('FREQ', 'Quarterly'), ('QUALIFIED?', 'Qualified'), ('DECLARED_DATE', datetime.date(2023, 11, 15)), ('EX-DIV_DATE', datetime.date(2023, 12, 14)), ('PAY_DATE', datetime.date(2023, 1, 10)), ('AMOUNT', 0.45), ('LAST_AMOUNT', 0.45), ('CHANGE', 'NO CHANGE'), ('DECLARED?', 'Declared')], [('NAME', 'Morgan Stanley - FXDFR PRF PERPETUAL USD 25 - Ser I'), ('YIELD', 6.42), ('FWD_DIV', 1.59), ('FREQ', 'Quarterly'), ('QUALIFIED?', 'Qualified'), ('DECLARED_DATE', datetime.date(2023, 11, 15)), ('EX-DIV_DATE', datetime.date(2023, 12, 28)), ('PAY_DATE', datetime.date(2023, 1, 16)), ('AMOUNT', 0.4), ('LAST_AMOUNT', 0.4), ('CHANGE', 'NO CHANGE'), ('DECLARED?', 'Declared')], [('NAME', 'Morgan Stanley - FXDFR PRF PERPETUAL USD 25 - Ser F'), ('YIELD', 6.82), ('FWD_DIV', 1.72), ('FREQ', 'Quarterly'), ('QUALIFIED?', 'Qualified'), ('DECLARED_DATE', datetime.date(2023, 11, 15)), ('EX-DIV_DATE', datetime.date(2023, 12, 28)), ('PAY_DATE', datetime.date(2023, 1, 16)), ('AMOUNT', 0.43), ('LAST_AMOUNT', 0.43), ('CHANGE', 'NO CHANGE'), ('DECLARED?', 'Declared')], [('NAME', 'Morgan Stanley - FXDFR PRF PERPETUAL USD 25 - Ser E'), ('YIELD', 7.19), ('FWD_DIV', 1.82), ('FREQ', 'Quarterly'), ('QUALIFIED?', 'Qualified'), ('DECLARED_DATE', datetime.date(2023, 11, 15)), ('EX-DIV_DATE', datetime.date(2023, 12, 28)), ('PAY_DATE', datetime.date(2023, 1, 16)), ('AMOUNT', 0.46), ('LAST_AMOUNT', 0.45), ('CHANGE', 'INCREASE'), ('DECLARED?', 'Declared')], [('NAME', 'TFS FINANCIAL CORPORATION'), ('YIELD', 8.28), ('FWD_DIV', 1.13), ('FREQ', 'Quarterly'), ('QUALIFIED?', 'Qualified'), ('DECLARED_DATE', datetime.date(2023, 11, 15)), ('EX-DIV_DATE', datetime.date(2023, 11, 28)), ('PAY_DATE', datetime.date(2023, 12, 13)), ('AMOUNT', 0.28), ('LAST_AMOUNT', 0.28), ('CHANGE', 'NO CHANGE'), ('DECLARED?', 'Declared')], [('NAME', 'ROCKY BRANDS, INC.'), ('YIELD', 2.49), ('FWD_DIV', 0.62), ('FREQ', 'Quarterly'), ('QUALIFIED?', 'Qualified'), ('DECLARED_DATE', datetime.date(2023, 11, 15)), ('EX-DIV_DATE', datetime.date(2023, 11, 30)), ('PAY_DATE', datetime.date(2023, 12, 15)), ('AMOUNT', 0.16), ('LAST_AMOUNT', 0.16), ('CHANGE', 'NO CHANGE'), ('DECLARED?', 'Declared')], [('NAME', 'Morgan Stanley - 4.875% PRF PERPETUAL USD 25 - Ser L'), ('YIELD', 6.02), ('FWD_DIV', 1.22), ('FREQ', 'Quarterly'), ('QUALIFIED?', 'Qualified'), ('DECLARED_DATE', datetime.date(2023, 11, 15)), ('EX-DIV_DATE', datetime.date(2023, 12, 28)), ('PAY_DATE', datetime.date(2023, 1, 16)), ('AMOUNT', 0.3), ('LAST_AMOUNT', 0.3), ('CHANGE', 'NO CHANGE'), ('DECLARED?', 'Declared')], [('NAME', 'MainStreet Bancshares, Inc.'), ('YIELD', 8.75), ('FWD_DIV', 1.88), ('FREQ', 'Quarterly'), ('QUALIFIED?', 'Qualified'), ('DECLARED_DATE', datetime.date(2023, 11, 15)), ('EX-DIV_DATE', datetime.date(2023, 12, 14)), ('PAY_DATE', datetime.date(2023, 12, 29)), ('AMOUNT', 0.47), ('LAST_AMOUNT', 0.47), ('CHANGE', 'NO CHANGE'), ('DECLARED?', 'Declared')], [('NAME', 'Insperity, Inc.'), ('YIELD', 2.03), ('FWD_DIV', 2.28), ('FREQ', 'Quarterly'), ('QUALIFIED?', 'Qualified'), ('DECLARED_DATE', datetime.date(2023, 11, 15)), ('EX-DIV_DATE', datetime.date(2023, 12, 1)), ('PAY_DATE', datetime.date(2023, 12, 18)), ('AMOUNT', 0.57), ('LAST_AMOUNT', 0.57), ('CHANGE', 'NO CHANGE'), ('DECLARED?', 'Declared')], [('NAME', 'AGILENT TECHNOLOGIES, INC.'), ('YIELD', 0.83), ('FWD_DIV', 0.94), ('FREQ', 'Quarterly'), ('QUALIFIED?', 'Qualified'), ('DECLARED_DATE', datetime.date(2023, 11, 15)), ('EX-DIV_DATE', datetime.date(2023, 12, 29)), ('PAY_DATE', datetime.date(2023, 1, 24)), ('AMOUNT', 0.24), ('LAST_AMOUNT', 0.23), ('CHANGE', 'INCREASE'), ('DECLARED?', 'Declared')], [('NAME', 'Gabelli Dividend & Income Trust - 5.375% PRF PERPETUAL USD 25 - Ser H'), ('YIELD', 5.64), ('FWD_DIV', 1.34), ('FREQ', 'Quarterly'), ('QUALIFIED?', 'Unknown'), ('DECLARED_DATE', datetime.date(2023, 11, 15)), ('EX-DIV_DATE', datetime.date(2023, 12, 15)), ('PAY_DATE', datetime.date(2023, 12, 26)), ('AMOUNT', 0.34), ('LAST_AMOUNT', 0.34), ('CHANGE', 'NO CHANGE'), ('DECLARED?', 'Declared')], [('NAME', 'Andover Bancorp Inc. Ohio'), ('YIELD', 3.8), ('FWD_DIV', 0.75), ('FREQ', 'Semi Annually'), ('QUALIFIED?', 'Qualified'), ('DECLARED_DATE', datetime.date(2023, 11, 15)), ('EX-DIV_DATE', datetime.date(2023, 12, 12)), ('PAY_DATE', datetime.date(2023, 1, 2)), ('AMOUNT', 0.38), ('LAST_AMOUNT', 0.38), ('CHANGE', 'NO CHANGE'), ('DECLARED?', 'Declared')], [('NAME', 'Brighthouse Financial, Inc.'), ('YIELD', 8.09), ('FWD_DIV', 1.16), ('FREQ', 'Quarterly'), ('QUALIFIED?', 'Qualified'), ('DECLARED_DATE', datetime.date(2023, 11, 15)), ('EX-DIV_DATE', datetime.date(2023, 12, 7)), ('PAY_DATE', datetime.date(2023, 12, 26)), ('AMOUNT', 0.29), ('LAST_AMOUNT', 0.29), ('CHANGE', 'NO CHANGE'), ('DECLARED?', 'Declared')], [('NAME', 'Brighthouse Financial, Inc.'), ('YIELD', 7.84), ('FWD_DIV', 1.65), ('FREQ', 'Quarterly'), ('QUALIFIED?', 'Non-qualified'), ('DECLARED_DATE', datetime.date(2023, 11, 15)), ('EX-DIV_DATE', datetime.date(2023, 12, 7)), ('PAY_DATE', datetime.date(2023, 12, 26)), ('AMOUNT', 0.41), ('LAST_AMOUNT', 0.41), ('CHANGE', 'NO CHANGE'), ('DECLARED?', 'Declared')], [('NAME', 'Gaslog Partners LP - FXDFR PRF PERPETUAL USD 25 - Ser C'), ('YIELD', 9.17), ('FWD_DIV', 2.13), ('FREQ', 'Quarterly'), ('QUALIFIED?', 'Qualified'), ('DECLARED_DATE', datetime.date(2023, 11, 15)), ('EX-DIV_DATE', datetime.date(2023, 12, 7)), ('PAY_DATE', datetime.date(2023, 12, 15)), ('AMOUNT', 0.53), ('LAST_AMOUNT', 0.53), ('CHANGE', 'NO CHANGE'), ('DECLARED?', 'Declared')], [('NAME', 'HIREQUEST, INC.'), ('YIELD', 1.63), ('FWD_DIV', 0.24), ('FREQ', 'Quarterly'), ('QUALIFIED?', 'Qualified'), ('DECLARED_DATE', datetime.date(2023, 11, 15)), ('EX-DIV_DATE', datetime.date(2023, 11, 30)), ('PAY_DATE', datetime.date(2023, 12, 15)), ('AMOUNT', 0.06), ('LAST_AMOUNT', 0.06), ('CHANGE', 'NO CHANGE'), ('DECLARED?', 'Declared')], [('NAME', 'KAMAN CORPORATION'), ('YIELD', 3.92), ('FWD_DIV', 0.8), ('FREQ', 'Quarterly'), ('QUALIFIED?', 'Qualified'), ('DECLARED_DATE', datetime.date(2023, 11, 15)), ('EX-DIV_DATE', datetime.date(2023, 12, 18)), ('PAY_DATE', datetime.date(2023, 1, 11)), ('AMOUNT', 0.2), ('LAST_AMOUNT', 0.2), ('CHANGE', 'NO CHANGE'), ('DECLARED?', 'Declared')], [('NAME', 'QUAKER CHEMICAL CORPORATION'), ('YIELD', 1.04), ('FWD_DIV', 1.82), ('FREQ', 'Quarterly'), ('QUALIFIED?', 'Qualified'), ('DECLARED_DATE', datetime.date(2023, 11, 15)), ('EX-DIV_DATE', datetime.date(2023, 1, 16)), ('PAY_DATE', datetime.date(2023, 1, 31)), ('AMOUNT', 0.46), ('LAST_AMOUNT', 0.46), ('CHANGE', 'NO CHANGE'), ('DECLARED?', 'Declared')], [('NAME', 'KULICKE AND SOFFA INDUSTRIES, INC.'), ('YIELD', 1.58), ('FWD_DIV', 0.8), ('FREQ', 'Quarterly'), ('QUALIFIED?', 'Unknown'), ('DECLARED_DATE', datetime.date(2023, 11, 15)), ('EX-DIV_DATE', datetime.date(2023, 12, 20)), ('PAY_DATE', datetime.date(2023, 1, 9)), ('AMOUNT', 0.2), ('LAST_AMOUNT', 0.19), ('CHANGE', 'INCREASE'), ('DECLARED?', 'Declared')], [('NAME', 'Merchants Bancorp'), ('YIELD', 6.9), ('FWD_DIV', 1.5), ('FREQ', 'Quarterly'), ('QUALIFIED?', 'Qualified'), ('DECLARED_DATE', datetime.date(2023, 11, 15)), ('EX-DIV_DATE', datetime.date(2023, 12, 14)), ('PAY_DATE', datetime.date(2023, 1, 2)), ('AMOUNT', 0.38), ('LAST_AMOUNT', 0.38), ('CHANGE', 'NO CHANGE'), ('DECLARED?', 'Declared')], [('NAME', 'Merchants Bancorp'), ('YIELD', 0.97), ('FWD_DIV', 0.32), ('FREQ', 'Quarterly'), ('QUALIFIED?', 'Qualified'), ('DECLARED_DATE', datetime.date(2023, 11, 15)), ('EX-DIV_DATE', datetime.date(2023, 12, 14)), ('PAY_DATE', datetime.date(2023, 1, 2)), ('AMOUNT', 0.08), ('LAST_AMOUNT', 0.08), ('CHANGE', 'NO CHANGE'), ('DECLARED?', 'Declared')], [('NAME', 'Merchants Bancorp'), ('YIELD', 8.12), ('FWD_DIV', 1.5), ('FREQ', 'Quarterly'), ('QUALIFIED?', 'Qualified'), ('DECLARED_DATE', datetime.date(2023, 11, 15)), ('EX-DIV_DATE', datetime.date(2023, 12, 14)), ('PAY_DATE', datetime.date(2023, 1, 2)), ('AMOUNT', 0.38), ('LAST_AMOUNT', 0.38), ('CHANGE', 'NO CHANGE'), ('DECLARED?', 'Declared')], [('NAME', 'Equitable Holdings Inc - 5.25% PRF PERPETUAL USD 25 - 1/1000th Int Ser A/2023'), ('YIELD', 6.51), ('FWD_DIV', 1.31), ('FREQ', 'Quarterly'), ('QUALIFIED?', 'Qualified'), ('DECLARED_DATE', datetime.date(2023, 11, 15)), ('EX-DIV_DATE', datetime.date(2023, 12, 1)), ('PAY_DATE', datetime.date(2023, 12, 15)), ('AMOUNT', 0.33), ('LAST_AMOUNT', 0.33), ('CHANGE', 'NO CHANGE'), ('DECLARED?', 'Declared')], [('NAME', 'Air Products & Chemicals, Inc.'), ('YIELD', 2.59), ('FWD_DIV', 7.0), ('FREQ', 'Quarterly'), ('QUALIFIED?', 'Qualified'), ('DECLARED_DATE', datetime.date(2023, 11, 15)), ('EX-DIV_DATE', datetime.date(2023, 12, 29)), ('PAY_DATE', datetime.date(2023, 2, 12)), ('AMOUNT', 1.75), ('LAST_AMOUNT', 1.75), ('CHANGE', 'NO CHANGE'), ('DECLARED?', 'Declared')], [('NAME', 'Dole plc'), ('YIELD', 2.86), ('FWD_DIV', 0.32), ('FREQ', 'Quarterly'), ('QUALIFIED?', 'Unknown'), ('DECLARED_DATE', datetime.date(2023, 11, 15)), ('EX-DIV_DATE', datetime.date(2023, 12, 13)), ('PAY_DATE', datetime.date(2023, 1, 4)), ('AMOUNT', 0.08), ('LAST_AMOUNT', 0.08), ('CHANGE', 'NO CHANGE'), ('DECLARED?', 'Declared')], [('NAME', 'ESSA Bancorp, Inc.'), ('YIELD', 3.64), ('FWD_DIV', 0.6), ('FREQ', 'Quarterly'), ('QUALIFIED?', 'Qualified'), ('DECLARED_DATE', datetime.date(2023, 11, 15)), ('EX-DIV_DATE', datetime.date(2023, 12, 14)), ('PAY_DATE', datetime.date(2023, 12, 29)), ('AMOUNT', 0.15), ('LAST_AMOUNT', 0.15), ('CHANGE', 'NO CHANGE'), ('DECLARED?', 'Declared')], [('NAME', 'First Citizens Bancshares Inc'), ('YIELD', 2.5), ('FWD_DIV', 1.4), ('FREQ', 'Quarterly'), ('QUALIFIED?', 'Qualified'), ('DECLARED_DATE', datetime.date(2023, 11, 15)), ('EX-DIV_DATE', datetime.date(2023, 11, 30)), ('PAY_DATE', datetime.date(2023, 12, 15)), ('AMOUNT', 0.45), ('LAST_AMOUNT', 0.35), ('CHANGE', 'SPECIAL'), ('DECLARED?', 'Declared')], [('NAME', 'Financial Institutions, Inc.'), ('YIELD', 6.66), ('FWD_DIV', 1.2), ('FREQ', 'Quarterly'), ('QUALIFIED?', 'Qualified'), ('DECLARED_DATE', datetime.date(2023, 11, 15)), ('EX-DIV_DATE', datetime.date(2023, 12, 13)), ('PAY_DATE', datetime.date(2023, 1, 2)), ('AMOUNT', 0.3), ('LAST_AMOUNT', 0.3), ('CHANGE', 'NO CHANGE'), ('DECLARED?', 'Declared')], [('NAME', 'FIRST US BANCSHARES INC'), ('YIELD', 2.15), ('FWD_DIV', 0.2), ('FREQ', 'Quarterly'), ('QUALIFIED?', 'Qualified'), ('DECLARED_DATE', datetime.date(2023, 11, 15)), ('EX-DIV_DATE', datetime.date(2023, 12, 7)), ('PAY_DATE', datetime.date(2023, 1, 2)), ('AMOUNT', 0.05), ('LAST_AMOUNT', 0.05), ('CHANGE', 'NO CHANGE'), ('DECLARED?', 'Declared')], [('NAME', 'ALLSTATE CORP'), ('YIELD', 2.65), ('FWD_DIV', 3.56), ('FREQ', 'Quarterly'), ('QUALIFIED?', 'Qualified'), ('DECLARED_DATE', datetime.date(2023, 11, 15)), ('EX-DIV_DATE', datetime.date(2023, 11, 29)), ('PAY_DATE', datetime.date(2023, 1, 2)), ('AMOUNT', 0.89), ('LAST_AMOUNT', 0.89), ('CHANGE', 'NO CHANGE'), ('DECLARED?', 'Declared')], [('NAME', 'COMMUNITY BANK SYSTEM, INC.'), ('YIELD', 3.96), ('FWD_DIV', 1.8), ('FREQ', 'Quarterly'), ('QUALIFIED?', 'Qualified'), ('DECLARED_DATE', datetime.date(2023, 11, 15)), ('EX-DIV_DATE', datetime.date(2023, 12, 14)), ('PAY_DATE', datetime.date(2023, 1, 10)), ('AMOUNT', 0.45), ('LAST_AMOUNT', 0.45), ('CHANGE', 'NO CHANGE'), ('DECLARED?', 'Declared')], [('NAME', 'Morgan Stanley - FXDFR PRF PERPETUAL USD 25 - Ser I'), ('YIELD', 6.42), ('FWD_DIV', 1.59), ('FREQ', 'Quarterly'), ('QUALIFIED?', 'Qualified'), ('DECLARED_DATE', datetime.date(2023, 11, 15)), ('EX-DIV_DATE', datetime.date(2023, 12, 28)), ('PAY_DATE', datetime.date(2023, 1, 16)), ('AMOUNT', 0.4), ('LAST_AMOUNT', 0.4), ('CHANGE', 'NO CHANGE'), ('DECLARED?', 'Declared')], [('NAME', 'Morgan Stanley - FXDFR PRF PERPETUAL USD 25 - Ser F'), ('YIELD', 6.82), ('FWD_DIV', 1.72), ('FREQ', 'Quarterly'), ('QUALIFIED?', 'Qualified'), ('DECLARED_DATE', datetime.date(2023, 11, 15)), ('EX-DIV_DATE', datetime.date(2023, 12, 28)), ('PAY_DATE', datetime.date(2023, 1, 16)), ('AMOUNT', 0.43), ('LAST_AMOUNT', 0.43), ('CHANGE', 'NO CHANGE'), ('DECLARED?', 'Declared')], [('NAME', 'Morgan Stanley - FXDFR PRF PERPETUAL USD 25 - Ser E'), ('YIELD', 7.19), ('FWD_DIV', 1.82), ('FREQ', 'Quarterly'), ('QUALIFIED?', 'Qualified'), ('DECLARED_DATE', datetime.date(2023, 11, 15)), ('EX-DIV_DATE', datetime.date(2023, 12, 28)), ('PAY_DATE', datetime.date(2023, 1, 16)), ('AMOUNT', 0.46), ('LAST_AMOUNT', 0.45), ('CHANGE', 'INCREASE'), ('DECLARED?', 'Declared')], [('NAME', 'TFS FINANCIAL CORPORATION'), ('YIELD', 8.28), ('FWD_DIV', 1.13), ('FREQ', 'Quarterly'), ('QUALIFIED?', 'Qualified'), ('DECLARED_DATE', datetime.date(2023, 11, 15)), ('EX-DIV_DATE', datetime.date(2023, 11, 28)), ('PAY_DATE', datetime.date(2023, 12, 13)), ('AMOUNT', 0.28), ('LAST_AMOUNT', 0.28), ('CHANGE', 'NO CHANGE'), ('DECLARED?', 'Declared')], [('NAME', 'ROCKY BRANDS, INC.'), ('YIELD', 2.49), ('FWD_DIV', 0.62), ('FREQ', 'Quarterly'), ('QUALIFIED?', 'Qualified'), ('DECLARED_DATE', datetime.date(2023, 11, 15)), ('EX-DIV_DATE', datetime.date(2023, 11, 30)), ('PAY_DATE', datetime.date(2023, 12, 15)), ('AMOUNT', 0.16), ('LAST_AMOUNT', 0.16), ('CHANGE', 'NO CHANGE'), ('DECLARED?', 'Declared')], [('NAME', 'Morgan Stanley - 4.875% PRF PERPETUAL USD 25 - Ser L'), ('YIELD', 6.02), ('FWD_DIV', 1.22), ('FREQ', 'Quarterly'), ('QUALIFIED?', 'Qualified'), ('DECLARED_DATE', datetime.date(2023, 11, 15)), ('EX-DIV_DATE', datetime.date(2023, 12, 28)), ('PAY_DATE', datetime.date(2023, 1, 16)), ('AMOUNT', 0.3), ('LAST_AMOUNT', 0.3), ('CHANGE', 'NO CHANGE'), ('DECLARED?', 'Declared')], [('NAME', 'MainStreet Bancshares, Inc.'), ('YIELD', 8.75), ('FWD_DIV', 1.88), ('FREQ', 'Quarterly'), ('QUALIFIED?', 'Qualified'), ('DECLARED_DATE', datetime.date(2023, 11, 15)), ('EX-DIV_DATE', datetime.date(2023, 12, 14)), ('PAY_DATE', datetime.date(2023, 12, 29)), ('AMOUNT', 0.47), ('LAST_AMOUNT', 0.47), ('CHANGE', 'NO CHANGE'), ('DECLARED?', 'Declared')], [('NAME', 'Insperity, Inc.'), ('YIELD', 2.03), ('FWD_DIV', 2.28), ('FREQ', 'Quarterly'), ('QUALIFIED?', 'Qualified'), ('DECLARED_DATE', datetime.date(2023, 11, 15)), ('EX-DIV_DATE', datetime.date(2023, 12, 1)), ('PAY_DATE', datetime.date(2023, 12, 18)), ('AMOUNT', 0.57), ('LAST_AMOUNT', 0.57), ('CHANGE', 'NO CHANGE'), ('DECLARED?', 'Declared')]]
    data_handler = DataHandler(data)
    data_handler.convert_to_pandas_df()
    print(data_handler.data)
